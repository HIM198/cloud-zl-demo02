$(function(){if($.validator){$.validator.prototype.elements=function(){var b=this,a={};return $(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function(){var c=this.id||this.name||$(this).attr("name");if(!c&&b.settings.debug&&window.console){console.error("%o has no name assigned",this)}if(this.hasAttribute("contenteditable")){this.form=$(this).closest("form")[0]}if(c in a||!b.objectLength($(this).rules())){return false}a[c]=true;return true})}}});function logoutform(){layer.confirm("您确定要退出系统吗？",{btn:["确定","取消"]},function(){$("#logoutform").submit()});return false}function formRendering(b,a){formatFormSelect2(b,a);validateFormOfId(b)}function validateFormOfId(fid){$("#"+fid+" input[data-inputmask]").inputmask();$("#"+fid+" input[validate]").each(function(){if($(this).attr("data-options")){}else{if($(this).hasClass("dontValidate")){$(this).rules("remove")}else{var vstr=$(this).attr("validate");var conf=eval("("+vstr+")");if(conf.required){var label=$(this).parent().parent().find("label");var ll=label.find(".notnull");if(ll&&ll.length==1){}else{label.html(label.html()+"<span class='notnull'>*</span>")}}else{}if(conf.date){$(this).datepicker({language:ulocale,format:"yyyy-mm-dd",todayBtn:"linked",todayHighlight:true,autoclose:true})}if(conf.dateISO){$(this).datepicker({language:ulocale,format:"yyyy-mm-dd",todayBtn:"linked",todayHighlight:true,autoclose:true})}if(conf.datetime){$(this).datetimepicker({language:ulocale,weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,format:"yyyy-mm-dd hh:ii",forceParse:1})}}}});$("#"+fid+" select[validate]").each(function(){if($(this).attr("data-options")){}else{if($(this).hasClass("dontValidate")){$(this).validatebox("disableValidation")}else{var vstr=$(this).attr("validate");var conf=eval("("+vstr+")");if(conf.required){var label=$(this).parent().parent().find("label");var ll=label.find(".notnull");if(ll&&ll.length==1){}else{label.html(label.html()+"<span class='notnull'>*</span>")}}else{}}}});$("#"+fid+" textarea[validate]").each(function(){if($(this).attr("data-options")){}else{if($(this).hasClass("dontValidate")){$(this).validatebox("disableValidation")}else{var vstr=$(this).attr("validate");var conf=eval("("+vstr+")");if(conf.required){var label=$(this).parent().parent().find("label");var ll=label.find(".notnull");if(ll&&ll.length==1){}else{label.html(label.html()+"<span class='notnull'>*</span>")}}else{}}}})}function validateFrom(){$("form input[data-inputmask]").inputmask();$("form input[validate]").each(function(){if($(this).attr("data-options")){}else{if($(this).hasClass("dontValidate")){$(this).rules("remove")}else{var vstr=$(this).attr("validate");var conf=eval("("+vstr+")");if(conf.required){var label=$(this).parent().parent().find("label");var ll=label.find(".notnull");if(ll&&ll.length==1){}else{label.html(label.html()+"<span class='notnull'>*</span>")}}else{}if(conf.date){$(this).datepicker({language:ulocale,format:"yyyy-mm-dd",todayBtn:"linked",todayHighlight:true,autoclose:true})}if(conf.dateISO){$(this).datepicker({language:ulocale,format:"yyyy-mm-dd",todayBtn:"linked",todayHighlight:true,autoclose:true})}if(conf.datetime){$(this).datetimepicker({language:ulocale,weekStart:1,todayBtn:1,autoclose:1,todayHighlight:1,format:"yyyy-mm-dd hh:ii",forceParse:1})}}}});$("form select[validate]").each(function(){if($(this).attr("data-options")){}else{if($(this).hasClass("dontValidate")){$(this).validatebox("disableValidation")}else{var vstr=$(this).attr("validate");var conf=eval("("+vstr+")");if(conf.required){var label=$(this).parent().parent().find("label");var ll=label.find(".notnull");if(ll&&ll.length==1){}else{label.html(label.html()+"<span class='notnull'>*</span>")}}else{}}}});$("form textarea[validate]").each(function(){if($(this).attr("data-options")){}else{if($(this).hasClass("dontValidate")){$(this).validatebox("disableValidation")}else{var vstr=$(this).attr("validate");var conf=eval("("+vstr+")");if(conf.required){var label=$(this).parent().parent().find("label");var ll=label.find(".notnull");if(ll&&ll.length==1){}else{label.html(label.html()+"<span class='notnull'>*</span>")}}else{}}}})}function formRest(){$("form").each(function(){$(this).on("reset",function(){$(this).find("input[type='text'],input[type='password'],textarea").each(function(){if($(this).attr("ifreset")){}else{if($(this).attr("disabled")){}else{$(this).attr("value","");$(this).val("")}}});$(this).find("input[type='hidden']").each(function(){if($(this).attr("ifreset")){$(this).attr("value","");$(this).val("")}else{}});$(this).find("select").each(function(){if($(this).attr("ifreset")){}else{if($(this).attr("disabled")){}else{$(this).find("option").first().attr("selected",true)}}});$(this).find(".select2").each(function(){if($(this).attr("ifreset")){}else{if($(this).attr("disabled")){}else{$(this).val(null).trigger("change")}}});return false})})}function showInputFormResponseHasCallbak(g,b,k,a,j){bUnloadMask();try{var e=g;if(e.success){if(e.message&&e.message!=""){showMsgBRN(t_alert_title,e.message,5)}var f=$(a).find("#form_addOrUpdate_pk");var h=$(a).find("#inputflag");if(f.length==1&&h.length==1){if(h.val()=="1"){$(a).find("#div_add_pk").append('<input type="hidden" css="id" id="'+f.attr("name")+'" name="'+f.attr("name")+'" value="'+e.id+'" />');f.attr("disabled",true);h.val("2");f.value=e.id;var d=$(a).find("#jxtj");if(d.length>0){d.css("display","inline")}}}}else{showMsgBRN(t_alert_title,e.message,1)}$("input[class^='search_btn']").each(function(){$(this).attr("disabled",false)});$(".btn-danger").each(function(){$(this).attr("disabled",false)});if(j&&j!=null){j(e)}}catch(c){showMsgBRN(t_alert_title,t_form_submit_noright,1)}}function ajaxSubmitFormById(d,b,c){var a={beforeSubmit:function(){bloadMask();$("input[class^='search_btn']").each(function(){$(this).attr("disabled",true)});$(".btn-danger").each(function(){$(this).attr("disabled",true)})},error:function(e,g,f){bUnloadMask();$("input[class^='search_btn']").each(function(){$(this).attr("disabled",false)});$(".btn-danger").each(function(){$(this).attr("disabled",false)});msgShowN(t_alert_title,t_form_submit_noright,1)},success:function(h,g,e,j){showInputFormResponseHasCallbak(h,g,e,j,b)}};if($("#"+d).valid()){confirm_swal_form(t_form_submit_title,t_form_submit_txt,"warning",function(e){if(e){$("#"+d).ajaxSubmit(a)}else{}})}else{$("#"+d).validate()}}function ajaxSubmitFormByIdNoConfirm(c,b){var a={beforeSubmit:function(){bloadMask();$("input[class^='search_btn']").each(function(){$(this).attr("disabled",true)})},error:function(d,f,e){bUnloadMask();msgShowN(t_alert_title,t_form_submit_noright,1)},success:function(g,e,d,h){showInputFormResponseHasCallbak(g,e,d,h,b)}};if($("#"+c).valid()){$("#"+c).ajaxSubmit(a)}else{$("#"+c).validate()}}function orderbytable(){var a=$("#orderBy").val();var b=$("#order").val();$("th.orderby").each(function(){if(a){if($(this).attr("oc")==a){if($(this).children("span").html()){$(this).find("span").addClass(b)}else{$(this).append("&nbsp;<span class='"+b+"'>&nbsp;&nbsp;</span>")}$(this).attr("ot",b)}else{$(this).append("&nbsp;<span class='no'>&nbsp;&nbsp;</span>")}}else{$(this).append("&nbsp;<span class='no'>&nbsp;&nbsp;</span>")}})}function formTablelistStyle(){orderbytable();$("th.orderby").click(function(){var b=$(this).attr("ot");if(b){if(b=="asc"){b="desc";$(this).removeClass("asc");$(this).addClass("desc")}else{b="asc";$(this).addClass("asc");$(this).removeClass("desc")}}else{b="asc"}$(this).attr("ot",b);$("#orderBy").val($(this).attr("oc"));$("#order").val(b);var a=$(this).attr("of");if(a){$("#"+a).submit()}else{$("form").first().submit()}})}function createFrame(a,c){var b;if(c){b='<iframe id="'+c+'" scrolling="auto" frameborder="0"  src="'+a+'" style="width:100%;height:100%;"></iframe>'}else{b='<iframe scrolling="auto" frameborder="0"  src="'+a+'" style="width:100%;height:100%;"></iframe>'}return b}function msgShow(d,e,c){var a=null;if(e){}else{e=d;d=""}if(c){if(c==1){a="error"}else{if(c==2){a="info"}else{if(c==3){a="warning"}else{if(c==4){a="warning"}else{if(c==5){a="success"}else{a=c}}}}}}else{a="warning"}if($.isEmptyObject(d)||d==""){d=t_alert_title}var b=window.parent;if(b!=null){b.swal({title:d,text:e,type:a})}else{swal({title:d,text:e,type:a})}}function msgShowN(c,d,b){var a=null;if(d){}else{d=c;c=""}if(b){if(b==1){a="error"}else{if(b==2){a="info"}else{if(b==3){a="warning"}else{if(b==4){a="warning"}else{if(b==5){a="success"}else{a=b}}}}}}else{a="warning"}if($.isEmptyObject(c)||c==""){c=t_alert_title}setTimeout(function(){swal(c,d,a)},500)}var loadnum=0;function bloadMask(){loadnum++;if(loadnum==1){$(document.body).mask()}}function bUnloadMask(){loadnum--;if(loadnum<=0){$(document.body).unmask()}}function loadMask(b,c){var a="玩命处理中...请稍候！";if(c){$(b).mask(c)}else{$(b).mask(a)}}function unloadMask(a){$(a).unmask()}function showInputFormResponse(g,b,j,a){bUnloadMask();try{var e=g;if(e.success){showMsgBRN(t_alert_title,e.message,5);var f=$(a).find("#form_addOrUpdate_pk");var h=$(a).find("#inputflag");if(f.length==1&&h.length==1){if(h.val()=="1"){$(a).find("#div_add_pk").append('<input type="hidden" css="id" id="'+f.attr("name")+'" name="'+f.attr("name")+'" value="'+e.id+'" />');f.attr("disabled",true);h.val("2");f.value=e.id;var d=$(a).find("#jxtj");if(d.length>0){d.css("display","inline")}}}}else{showMsgBRN(t_alert_title,e.message,1)}$(".btn").each(function(){$(this).attr("disabled",false)})}catch(c){showMsgBRN(t_alert_title,t_form_submit_noright,1)}}function validateFormSubmit(){$.metadata.setType("attr","validate");var a={beforeSubmit:function(){bloadMask();$(".btn").each(function(){$(this).attr("disabled",true)})},error:function(b,d,c){msgShowN(t_alert_title,t_form_submit_noright,1)},success:showInputFormResponse};$("form.ajaxform").each(function(){$(this).validate({errorPlacement:function(b,c){var d=c.parent().find(".error_msg");if(d.length==1){b.appendTo(c.parent().find(".error_msg"))}else{b.appendTo(c.parent())}},submitHandler:function(b){confirm_swal_form(t_form_submit_title,t_form_submit_txt,"warning",function(c){if(c){$(b).ajaxSubmit(a)}else{}})}})});$("form.defaultform").each(function(){$(this).validate({submitHandler:function(b){confirm_swal_form(t_form_submit_title,t_form_submit_txt,"warning",function(c){if(c){b.submit()}else{}})}})});$("form.selectForm").each(function(){$(this).validate({submitHandler:function(b){b.submit()}})});$("form.selectForm_dt").each(function(){var b=$(this).attr("dtid");$(this).validate({submitHandler:function(c){$("#"+b).DataTable().ajax.reload(null,true)}})})}function eduLoadMask(a){if(a.startWith("/")){if(a.startWith(ctp)){location.href=a}else{location.href=ctp+a}}else{location.href=a}bloadMask()}function loadMaskUrl(a){eduLoadMask(a)}function bloadMaskUrl(a){if(a.startWith("/")){if(a.startWith(ctp)){location.href=a}else{location.href=ctp+a}}else{location.href=a}bloadMask()}function loadProgressUrl(a){if(a.startWith("/")){if(a.startWith(ctp)){location.href=a}else{location.href=ctp+a}}else{location.href=a}$.messager.progress()}function submitButtonDisAndHasMask(a){document.getElementById(a).disabled=true;bloadMask()}function setElmDisplay(a){$("#"+a).css("display","none")}function setElmUnDisplay(a){$("#"+a).css("display","")}function checkView(b,a,d){if(oneCheck(b)==true){var c=oneCheckValue(b);if(a.indexOf("?")>0){if(d!=null){loadMaskUrl(a+"&"+d+"="+c)}else{loadMaskUrl(a+"&id="+c)}}else{if(d!=null){loadMaskUrl(a+"?"+d+"="+c)}else{loadMaskUrl(a+"?id="+c)}}}else{msgShow(t_alert_title,t_datalist_oneCheck,4)}}function checkModify(b,a,d){if(oneCheck(b)==true){var c=oneCheckValue(b);if(a.indexOf("?")>0){if(d!=null){loadMaskUrl(a+"&"+d+"="+c)}else{loadMaskUrl(a+"&id="+c)}}else{if(d!=null){loadMaskUrl(a+"?"+d+"="+c)}else{loadMaskUrl(a+"?id="+c)}}}else{msgShow(t_alert_title,t_datalist_oneCheck,4)}}function confirm_swal(d,c,b,e){if(d==null){d=t_confirm_title}if(c==null){c="您确认执行此操作吗？"}if(b==null){b="warning"}var a=null;setTimeout(function(){if(a!=null){a.swal({title:d,text:c,type:b,showCancelButton:true,cancelButtonText:t_confirm_cancel,confirmButtonColor:"#DD6B55",confirmButtonText:t_confirm_ok,closeOnConfirm:true},function(f){if(e){e(f)}})}else{swal({title:d,text:c,type:b,showCancelButton:true,cancelButtonText:t_confirm_cancel,confirmButtonColor:"#DD6B55",confirmButtonText:t_confirm_ok,closeOnConfirm:true},function(f){if(e){e(f)}})}},500)}function confirm_swal_form(d,c,b,e){if(d==null){d=t_confirm_title}if(c==null){c="您确认执行此操作吗？"}if(b==null){b="warning"}var a=null;if(a!=null){a.swal({title:d,text:c,type:b,showCancelButton:true,cancelButtonText:t_confirm_cancel,confirmButtonColor:"#DD6B55",confirmButtonText:t_confirm_ok,closeOnConfirm:true},function(f){if(e){e(f)}})}else{swal({title:d,text:c,type:b,showCancelButton:true,cancelButtonText:t_confirm_cancel,confirmButtonColor:"#DD6B55",confirmButtonText:t_confirm_ok,closeOnConfirm:true},function(f){if(e){e(f)}})}}function ajaxDeleteSelect(c,d,a,b){if(dataTableAtleaseOneCheck(d)){confirm_swal_form(t_confirm_title,t_confirm_delete,"warning",function(e){if(e){$("#"+c).ajaxSubmit({url:a,beforeSubmit:function(){bloadMask()},error:function(f,h,g){msgShowN(t_alert_title,t_form_submit_noright,1)},success:function(j,k,l,h){try{var f=j;if(f.success){$("#"+c).find("input[name='"+d+"']:checkbox:checked").each(function(){$(this).parents("tr").remove()});if(b){$("#"+b).submit()}else{$("#selectForm").submit()}msgShowN(t_alert_title,f.message,5)}else{msgShowN(t_alert_title,f.message,1)}bUnloadMask()}catch(g){bUnloadMask();msgShowN(t_alert_title,t_form_submit_noright,1)}}})}else{}})}else{msgShow(t_alert_title,t_datalist_atleaseOneCheck,4)}}function dataTableAtleaseOneCheck(b){var c="";var a=false;$("input[name='"+b+"']:checkbox").each(function(){if($(this).parents("table.DTFC_Cloned").length>0){a=true;return}});if(a){$("input[name='"+b+"']:checkbox:checked").each(function(){if($(this).parents("table.DTFC_Cloned").length>0){if(c.indexOf($(this).val())<0){c+=$(this).val()+","}}})}else{$("input[name='"+b+"']:checkbox:checked").each(function(){if(c.indexOf($(this).val())<0){c+=$(this).val()+","}})}if(c==""){return false}else{return true}}function ajaxOperationSelect(b,d,c,e,a){if(dataTableAtleaseOneCheck(d)){confirm_swal_form(t_confirm_title,e,"warning",function(f){if(f){$("#"+b).ajaxSubmit({url:c,beforeSubmit:function(){bloadMask()},error:function(g,j,h){msgShowN(t_alert_title,t_form_submit_noright,1)},success:function(k,l,m,j){try{var g=k;if(g.success){if(a){$("#"+a).submit()}else{$("#selectForm").submit()}msgShowN(t_alert_title,g.message,5)}else{msgShowN(t_alert_title,g.message,1)}bUnloadMask()}catch(h){bUnloadMask();msgShowN(t_alert_title,t_form_submit_noright,1)}}})}else{}})}else{msgShow(t_alert_title,t_datalist_atleaseOneCheck,4)}}function getSubSelect(thisvalue,sub_id,sub_dic_no,checkValue){var url=ctp+"/selectOption/getByFilter";$.ajax({url:url,data:"key="+sub_dic_no+"&ivalue="+thisvalue,success:function(msg){var array=eval(msg);var s=document.getElementById(sub_id);s.options.length=0;s.options.add(new Option("---请选择---",""));for(var i=0;i<array.length;i++){if(checkValue==array[i].K){s.options.add(new Option(array[i].V,array[i].K,"selected"))}else{s.options.add(new Option(array[i].V,array[i].K))}}}})}function getSubSelectN(e,b,a,d){var c=ctp+"/selectOption/getByFilter";$.ajax({url:c,data:"key="+a+"&ivalue="+e,type:"POST",success:function(h){var j=h;var g="<option value=''>---请选择---</option>";for(var f=0;f<j.length;f++){g+="<option value='"+j[f].K+"'>"+j[f].V+"</option>"}$("#"+b).html(g);$("#"+b).val(d)}})}function getDict(a,d,c){var b=ctp+"/selectOption/getDict";$.ajax({url:b,data:"key="+d,type:"POST",success:function(g){var h=g;var f="<option value=''>---请选择---</option>";for(var e=0;e<h.length;e++){f+="<option value='"+h[e].K+"'>"+h[e].V+"</option>"}$("#"+a).html(f);$("#"+a).val(c)}})}function getDictN(a,e,d,c){var b=ctp+"/selectOption!getDict.action";var f="key="+e;if(typeof(c)=="undefined"){}else{f+="&ivalue="+c}$.ajax({url:b,data:f,type:"POST",success:function(o){var p=o;var n="<option value=''>---请选择---</option>";if(typeof(d)!="undefined"&&d!=""&&d!=null){var m=d.split(",");for(var l=0;l<p.length;l++){var g=false;var k=p[l].K;for(var h=0;h<m.length;h++){if(k==m[h]){g=true;break}}if(g){n+="<option value='"+k+"' selected>"+p[l].V+"</option>"}else{n+="<option value='"+k+"'>"+p[l].V+"</option>"}}}else{for(var l=0;l<p.length;l++){n+="<option value='"+p[l].K+"'>"+p[l].V+"</option>"}}$("#"+a).html(n)}})}function getSubSelectF(g,f,a,d,c){var e="";if(c){e=c}else{}if(ctp){e=ctp}else{}var b=e+"/selectOption/getByFilter";$.ajax({url:b,data:"key="+g+"&ivalue="+document.getElementById(f).value,type:"POST",success:function(k){var l=k;var j=document.getElementById(a);j.options.length=0;j.options.add(new Option("---请选择---",""));for(var h=0;h<l[0].length;h++){if(d==l[0][h].K){j.options.add(new Option(l[0][h].V,l[0][h].K,"selected"))}else{j.options.add(new Option(l[0][h].V,l[0][h].K))}}}})}function getSubSelectUrl(b,e,a,d,c){if(c&&c!=null&&c!=""){b=c+b}$.ajax({url:b,data:e,success:function(h){var j=$.parseJSON(h);var g=document.getElementById(a);g.options.length=0;g.options.add(new Option("---请选择---",""));for(var f=0;f<j[0].length;f++){if(d==j[0][f].K){g.options.add(new Option(j[0][f].V,j[0][f].K,"selected"))}else{g.options.add(new Option(j[0][f].V,j[0][f].K))}}}})}function confirmUI(a,b){confirmOption(a,b)}function ajaxtest(a,b,c){if(a.startWith("/")){if(a.startWith(ctp)){}else{a=ctp+a}}bloadMask();$.ajax({url:a,data:b,type:"POST",success:function(d){bUnloadMask();if(c){c(d)}}})}function ajaxtestT(a,b,c){bloadMask();$.ajax({async:false,url:a,data:b,type:"POST",success:function(d){bUnloadMask();if(c){c(d)}}})}function getAjaxDate(a,b){if(a.startWith("/")){if(a.startWith(ctp)){}else{a=ctp+a}}var c={};$.ajax({async:false,cache:false,type:"POST",url:a,data:b,success:function(e){try{c=e}catch(d){c={}}}});return c}function getAsAjaxDate(a,b){if(a.startWith("/")){if(a.startWith(ctp)){}else{a=ctp+a}}var c={};$.ajax({async:true,cache:false,type:"POST",url:a,data:b,success:function(e){try{c=e}catch(d){c={}}}});return c}function checkPageSize(a,c,b){if(!isInteger(a)){msgShow("输入不合法");setElementValue("pageSize","");return}if(a<1){msgShow("请输入大于0的整数");setElementValue("pageSize","");return}setElementValue("pageSize",a);b.submit();$.messager.progress()}function checkGotoPage(a,c,d,b){if(!isInteger(d)){msgShow("输入不合法");return}if(d<1){msgShow("请输入大于0的整数");return}if(a==d){return}setElementValue("pageNo",d);setElementValue("pager.offset",(d-1)*c);b.submit();$.messager.progress()}function showMsgBRN(e,f,c,d){var a=null;if(f){}else{f=e;e=""}if(c){if(c==1){a="error"}else{if(c==2){a="info"}else{if(c==3){a="warning"}else{if(c==4){a="warning"}else{if(c==5){a="success"}else{a=c}}}}}}else{a="warning"}if(d){}else{d=30000}if(e||e==""){}else{e="系统消息"}var b=window.parent;if(b!=null){b.toastr.options={closeButton:true,progressBar:true,showMethod:"slideDown",positionClass:"toast-bottom-right",timeOut:d};b.toastr[a](f,e)}else{toastr.options={closeButton:true,progressBar:true,showMethod:"slideDown",positionClass:"toast-bottom-right",timeOut:d};toastr[a](f,e)}}function checkDelete(a){confirmOption("您确定要删除吗?",function(b){if(b){location.href=a;bloadMask()}else{}})}function checkTj(a){confirmOption("您确定要提交吗?",function(b){if(b){location.href=a;bloadMask()}else{}})}function confirmOption(a,b){confirm_swal_form(t_confirm_title,a,"warning",b)}function confirmUrl(a,c){var b=c;if(c){}else{b="请确认操作！"}confirm_swal(t_form_submit_title,b,"warning",function(d){if(d){location.href=a;bloadMask();return true}else{}})}function confirmUrlMsg(a,c,d){var b=c;if(c){}else{b="请确认操作！"}confirm_swal(t_form_submit_title,b,"warning",function(e){if(e){bloadMask();$.ajax({url:a,type:"POST",success:function(f){if(f.success){bUnloadMask();try{if(d){d(f)}}catch(g){msgShow(t_alert_title,"没有权限操作！",1)}}else{bUnloadMask();try{if(d){d(f)}msgShow(t_alert_title,f.message,5)}catch(g){msgShow(t_alert_title,"没有权限操作！",1)}}}});return true}else{}})}function deleteRowHasFlushDt(a,c,b){ajaxOperationHasFlushDt("您确定要删除吗?",a,c,b)}function ajaxOperationHasFlushDt(d,a,c,b){confirmOption(d,function(e){if(e){ajaxtest(a,c,function(g){try{if(g.success){$("#"+b).DataTable().ajax.reload(null,true);showMsgBRN(t_alert_title,g.message,5)}else{showMsgBRN(t_alert_title,g.message,1)}}catch(f){showMsgBRN(t_alert_title,t_form_submit_noright,1)}})}})}function sleep(b){var a=new Date();var c=a.getTime()+b;while(true){a=new Date();if(a.getTime()>c){return}}}function setPFrameHeightAdd(b){var a=$(document).height()+b;mainPFrame.height(a)}function viewDataTablesRow(a,d,g,f){var c=$("#"+a).DataTable();var b=c.row("tr.row_selected").data();var e="";if(b!=null){e=b[g+""]}else{if(oneCheck("ids")){e=oneCheckValue("ids")}}if(e!=""){if(d.indexOf("?")>0){if(f!=null){loadMaskUrl(d+"&"+f+"="+e)}else{loadMaskUrl(d+"&id="+e)}}else{if(f!=null){loadMaskUrl(d+"?"+f+"="+e)}else{loadMaskUrl(d+"?id="+e)}}}else{msgShow(t_alert_title,t_datalist_oneCheck,4)}}function editDataTablesRow(a,b,d,c){viewDataTablesRow(a,b,d,c)}function deleteDataTablesRow(b,d,a,c){if(dataTableAtleaseOneCheck(d)){confirm_swal_form(t_confirm_title,t_confirm_delete,"warning",function(e){if(e){$("#"+b).ajaxSubmit({url:a,beforeSubmit:function(){bloadMask()},error:function(f,h,g){msgShowN(t_alert_title,t_form_submit_noright,1)},success:function(j,k,l,h){try{var f=j;if(f.success){$("#"+b).find("input[name='"+d+"']:checkbox:checked").each(function(){$(this).parents("tr").remove()});if(c){$("#"+c).DataTable().ajax.reload(null,false)}bUnloadMask();msgShowN(t_alert_title,f.message,5)}else{bUnloadMask();msgShowN(t_alert_title,f.message,1)}}catch(g){bUnloadMask();msgShowN(t_alert_title,t_form_submit_noright,1)}}})}else{}})}else{msgShow(t_alert_title,t_datalist_atleaseOneCheck,4)}}function dataTablesRowOption(c,e,b,d,f,g,a){if(dataTableAtleaseOneCheck(e)){confirm_swal_form(t_confirm_title,f,"warning",function(h){if(h){$("#"+c).ajaxSubmit({url:b,beforeSubmit:function(){bloadMask()},error:function(j,l,k){msgShowN(t_alert_title,t_form_submit_noright,1)},success:function(m,n,o,l){try{var j=m;if(j.success){if(d){if(a){if(a=="F"){}else{$("#"+d).DataTable().ajax.reload(null,false)}}else{$("#"+d).DataTable().ajax.reload(null,false)}}bUnloadMask();msgShowN(t_alert_title,j.message,5)}else{bUnloadMask();msgShowN(t_alert_title,j.message,1)}if(g){g(j)}}catch(k){bUnloadMask();msgShowN(t_alert_title,t_form_submit_noright,1)}}})}else{}})}else{msgShow(t_alert_title,t_datalist_atleaseOneCheck,4)}}function goExec(c,d,a){var e=c+"(";var b="";for(i=0;i<a;i++){b=b+d[i]+","}if(b.length>0){b=b.substr(0,b.length-1)}e=e+b+")";$.globalEval(e)}function setDatatableOfModule(tbid){if($("#"+tbid).attr("isAlready")=="true"){}else{$("#"+tbid).attr("isAlready","true")}var op=$("#"+tbid).attr("data-config");var conf=null;if(op){conf=eval("("+op+")")}else{conf=new Object()}if(conf.sfid){}else{conf.sfid="selectForm"}var dti=0;var sfid=conf.sfid;var columns=null;var pageLength=10;try{if(DT_pageLength&&typeof(DT_pageLength)!="undefined"&&DT_pageLength!=0){pageLength=DT_pageLength}}catch(e){pageLength=10}if(conf.pageLength){pageLength=conf.pageLength}else{if($("#"+sfid+" #pageSize").val()){pageLength=parseInt($("#"+sfid+" #pageSize").val(),10);conf.pageLength=pageLength}}bloadMask();var obj=getAjaxDate("/tools/module/datatable/config/get","tid="+$("#"+tbid).attr("tid")).data;var keyId=obj.keyId;conf.ordering=obj.ordering;conf.scrollX=obj.scrollX;if(obj.defaultOrderBy!=""){conf.defaultOrderBy=obj.defaultOrderBy;if(obj.defaultOrder!=""){conf.defaultOrder=obj.defaultOrder}else{conf.defaultOrder="asc"}$("#"+sfid+" #orderBy").val(conf.defaultOrderBy);$("#"+sfid+" #order").val(conf.defaultOrder)}if(obj.fixed){conf.fixedColumns={leftColumns:obj.fixedLeft,rightColumns:obj.fixedRight}}columns=obj.columns;$.each(columns,function(i,column){var renderFun=column.renderFun;var category=column.category;if(category!=null&&category!=""){if(category=="checkbox"&&(renderFun==null||renderFun=="")){column.createdCell=function(nTd,sData,oData,iRow,iCol){$(nTd).html("<div class='checkbox checkbox-primary' style='margin-top: -10px;padding-left:10px;'><input type='checkbox' class='styled' name='ids' value='"+sData+"'><label></label></div>")}}else{if(category=="number"){column.render=function(data,type,row,meta){dti++;return(meta.row+1)}}else{if(renderFun!=null&&renderFun!=""){if(renderFun.startWith("function(")){}else{renderFun="function(data, type, row, meta){ return "+renderFun+"(data, type, row, meta);}"}column.render=eval("("+renderFun+")")}}}}else{if(renderFun!=null&&renderFun!=""){if(renderFun.startWith("function(")){}else{renderFun="function(data, type, row, meta){ return "+renderFun+"(data, type, row, meta);}"}column.render=eval("("+renderFun+")")}}});var columnDefs=conf.columnDefs;if(columns){}else{columns=new Array()}var k=0;for(var j=0;j<columns.length;j++){var orderable=columns[j].orderable;if(orderable==false){}else{k=j;break}}if(columnDefs){}else{columnDefs=new Array()}var aLengthMenu=[[10,20,50,100,500],[10,20,50,100,500]];try{if(DT_aLengthMenu&&typeof(DT_aLengthMenu)!="undefined"){aLengthMenu=DT_aLengthMenu}}catch(e){aLengthMenu=[[10,20,50,100,500],[10,20,50,100,500]]}var d_option={language:{url:ctp+"/styles/skin_default/plugins/datatables/locale/"+user_language+".json"},ordering:true,aLengthMenu:aLengthMenu,pageLength:pageLength,destroy:true,searching:false,serverSide:true,processing:true,autoWidth:false,colReorder:true,dom:'t<"row" <"col-sm-3"i> <"col-sm-6"p> <"col-sm-3"l> >',createdRow:function(nRow,aData,iDataIndex){$(nRow).click(function(){if($(this).hasClass("row_selected")){$(this).removeClass("row_selected")}else{table.$("tr.row_selected").removeClass("row_selected");$(this).addClass("row_selected")}})},headerCallback:function(thead,data,start,end,display){$.each(columns,function(i,column){if(column.category!=null&&column.category!=""){if(column.category=="checkbox"){$(thead).find("th").eq(i).html('<div class="checkbox checkbox-primary" style="margin-top: -10px;padding-left: 10px;"><input type="checkbox" name="select" value="全 选" onclick="reserveCheck(\'ids\', this)" /><label></label></div>')}}})}};if(conf.searching&&conf.searching===true){d_option.dom='<"top"f>t<"row" <"col-sm-4"i> <"col-sm-6"p> <"col-sm-2"l> >'}var ajaxUrl=conf.ajaxUrl;if(ajaxUrl){ajaxUrl=ctp+ajaxUrl}else{ajaxUrl=$("#"+sfid+"").attr("action")}var option={ajax:{url:ajaxUrl,type:"POST",data:function(d,t){var start=d.start;var length=d.length;if(conf.ordering===false){}else{var order=table.order();if(order!=null&&order[0]!=null){var si=order[0][0];var sob=order[0][1];var sod=table.column(si).dataSrc();if(conf.ordering="undefined"||conf.ordering){$("#"+sfid+" #orderBy").val(sod);$("#"+sfid+" #order").val(sob)}}else{}}$("#"+sfid+" #pageNo").val(start/length+1);$("#"+sfid+" #pageSize").val(length);if($("#"+sfid+" #search").length==1){var search=table.search();$("#"+sfid+" #search").val(search)}d=$("#"+sfid+"").serialize();return d}},columnDefs:columnDefs,columns:columns};if(conf.ordering===false){}else{var rstr="asc";if(conf.defaultOrder){rstr=conf.defaultOrder}option.order=[[k,rstr]];if(conf.defaultOrderBy!=""){var orderFlag=false;for(var j=0;j<columns.length;j++){if(conf.defaultOrderBy==columns[j].data){option.order=[[j,rstr]];orderFlag=true;break}}if(!orderFlag){option.order=[]}}}d_option=$.extend({},d_option,conf);option=$.extend({},d_option,option);var table=$("#"+tbid).DataTable(option);bUnloadMask();table.on("xhr.dt",function(e,settings,json,xhr){dti=0;bUnloadMask();if(json.success){}else{msgShow(t_alert_title,json.message,1)}});table.on("preXhr.dt",function(e,settings,data){bloadMask()});table.on("error.dt",function(e,settings,techNote,message){msgShow(t_alert_title,"数据加载失败！",1)});$("#"+tbid+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{table.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+tbid+" tbody").on("mouseenter","td",function(){if(table.cell(this).index()){var colIdx=table.cell(this).index().column;$(table.cells().nodes()).removeClass("highlight");$(table.column(colIdx).nodes()).addClass("highlight")}});$("#"+tbid+" tbody").on("mouseleave","td",function(){if(table.cell(this).index()){var colIdx=table.cell(this).index().column;$(table.column(colIdx).nodes()).removeClass("highlight")}});table.on("column-reorder",function(e,settings,details){dti=0})}function setDefault_datatable(tbid){if($("#"+tbid).attr("isAlready")=="true"){}else{$("#"+tbid).attr("isAlready","true")}var op=$("#"+tbid).attr("data-config");var conf=null;if(op){conf=eval("("+op+")")}else{conf=new Object()}if(conf.sfid){}else{conf.sfid="selectForm"}var dti=0;var keyId=conf.keyId;var sfid=conf.sfid;var columns=conf.columns;var columnDefs=conf.columnDefs;if(columns){}else{columns=new Array()}var k=0;for(var j=0;j<columns.length;j++){var orderable=columns[j].orderable;if(orderable==false){}else{k=j;break}}if(columnDefs){}else{columnDefs=new Array()}var c_=0;var ct_=0;if(conf.checkbox){c_++}if(conf.number){c_++}if(conf.checkbox){columns.unshift({data:""+keyId,createdCell:function(nTd,sData,oData,iRow,iCol){$(nTd).html("<div class='checkbox checkbox-primary' style='margin-top: -10px;padding-left:10px;'><input type='checkbox' class='styled' name='ids' value='"+sData+"'><label></label></div>")}});columnDefs.unshift({width:40,searchable:false,orderable:false,targets:(c_-ct_-1)});ct_++}if(conf.number){columns.unshift({data:""+keyId});columnDefs.unshift({width:40,searchable:false,orderable:false,render:function(data,type,row){dti++;return"<span style='font-weight: bold'>"+dti+"</span>"},targets:(c_-ct_-1)});ct_++}var pageLength=10;try{if(DT_pageLength&&typeof(DT_pageLength)!="undefined"&&DT_pageLength!=0){pageLength=DT_pageLength}}catch(e){pageLength=10}if(conf.pageLength){pageLength=conf.pageLength}else{if($("#"+sfid+" #pageSize").val()){pageLength=parseInt($("#"+sfid+" #pageSize").val(),10);conf.pageLength=pageLength}}var aLengthMenu=[[10,20,50,100,500],[10,20,50,100,500]];try{if(DT_aLengthMenu&&typeof(DT_aLengthMenu)!="undefined"){aLengthMenu=DT_aLengthMenu}}catch(e){aLengthMenu=[[10,20,50,100,500],[10,20,50,100,500]]}var d_option={language:{url:ctp+"/styles/skin_default/plugins/datatables/locale/"+user_language+".json"},ordering:true,aLengthMenu:aLengthMenu,pageLength:pageLength,destroy:true,searching:false,serverSide:true,processing:true,autoWidth:false,dom:'t<"row dtpage" <"col-sm-3"i> <"col-sm-7"p> <"col-sm-2"l> >',createdRow:function(nRow,aData,iDataIndex){$(nRow).click(function(){if($(this).hasClass("row_selected")){$(this).removeClass("row_selected")}else{table.$("tr.row_selected").removeClass("row_selected");$(this).addClass("row_selected")}})}};if(conf.searching&&conf.searching===true){d_option.dom='<"top"f>t<"row" <"col-sm-4"i> <"col-sm-6"p> <"col-sm-2"l> >'}var ajaxUrl=conf.ajaxUrl;if(ajaxUrl){ajaxUrl=ctp+ajaxUrl}else{ajaxUrl=$("#"+sfid+"").attr("action")}var option={ajax:{url:ajaxUrl,type:"POST",data:function(d,t){var start=d.start;var length=d.length;if(conf.ordering===false){}else{var order=table.order();var si=order[0][0];var sob=order[0][1];var sod=table.column(si).dataSrc();if(conf.ordering="undefined"||conf.ordering){$("#"+sfid+" #orderBy").val(sod);$("#"+sfid+" #order").val(sob)}}$("#"+sfid+" #pageNo").val(start/length+1);$("#"+sfid+" #pageSize").val(length);if($("#"+sfid+" #search").length==1){var search=table.search();$("#"+sfid+" #search").val(search)}d=$("#"+sfid+"").serialize();return d}},columnDefs:columnDefs,columns:columns};if(conf.ordering===false){}else{var rstr="asc";if(conf.default_order){rstr=conf.default_order}option.order=[[ct_+k,rstr]];if(conf.default_orderBy){for(var j=0;j<columns.length;j++){if(conf.default_orderBy==columns[j].data){option.order=[[j,rstr]];break}}}}d_option=$.extend({},d_option,conf);option=$.extend({},d_option,option);if(option.scrollYAuto){option.scrollY=$(document).height()+option.scrollYAuto}var table=$("#"+tbid).DataTable(option);table.on("xhr.dt",function(e,settings,json,xhr){dti=0;bUnloadMask();if(json.success){}else{msgShow(t_alert_title,json.message,1)}});table.on("preXhr.dt",function(e,settings,data){bloadMask()});table.on("error.dt",function(e,settings,techNote,message){msgShow(t_alert_title,"数据加载失败！",1)});$("#"+tbid+" tbody").on("click","tr",function(){if($(this).hasClass("selected")){$(this).removeClass("selected")}else{table.$("tr.selected").removeClass("selected");$(this).addClass("selected")}});$("#"+tbid+" tbody").on("mouseenter","td",function(){if(table.cell(this).index()){var colIdx=table.cell(this).index().column;$(table.cells().nodes()).removeClass("highlight");$(table.column(colIdx).nodes()).addClass("highlight")}});$("#"+tbid+" tbody").on("mouseleave","td",function(){if(table.cell(this).index()){var colIdx=table.cell(this).index().column;$(table.column(colIdx).nodes()).removeClass("highlight")}})}function initDefault_datatable(){$(".dt_min").each(function(){var op=$(this).attr("data-config");var conf=null;if(op){conf=eval("("+op+")")}else{conf=new Object()}var table=$(this);var d_option={language:{url:ctp+"/styles/skin_default/plugins/datatables/locale/"+user_language+".json"},ordering:false,paging:false,retrieve:true,aLengthMenu:[[10,20,50,100,200],[10,20,50,100,200]],pageLength:10,searching:false,dom:'t<"row" <"col-sm-4"i> <"col-sm-6"p> <"col-sm-2"l> >',createdRow:function(nRow,aData,iDataIndex){$(nRow).click(function(){if($(this).hasClass("row_selected")){$(this).removeClass("row_selected")}else{table.$("tr.row_selected").removeClass("row_selected");$(this).addClass("row_selected")}})}};var option=$.extend({},d_option,conf);table=$(this).DataTable(option)});$(".dt_d").each(function(){setDefault_datatable($(this).attr("id"))});$(".dt_d_module").each(function(){setDatatableOfModule($(this).attr("id"))})}function formatSelect2(){$("select.select2").each(function(){if($(this).hasClass("select2-hidden-accessible")){}else{var voptions=$(this).attr("data-option");if(voptions){}else{voptions="{}"}var opts=eval("("+voptions+")");var sid=$(this).attr("id");var val=$(this).attr("pvalue");var d_option={placeholder:t_select2_placeholder,allowClear:true,language:user_language};if(opts.isSearch){}else{d_option.minimumResultsForSearch="Infinity"}var option=$.extend({},d_option,opts);var callBakFun=opts.pdataCallbackFun;if(opts.pageSize){}else{opts.pageSize=10}if(opts.url){if(opts.url.startWith("/")){if(opts.url.startWith(ctp)){}else{opts.url=ctp+opts.url}}if(opts.pageSize&&opts.pageSize>0){var pindex=$.extend({},{id:val},opts.pdata);option.data=getAjaxDate(opts.url,pindex);$(this).select2(option);if(val!=null&&val!=""&&val){if(val.indexOf(",")>=0){$(this).val(val.split(",")).trigger("change")}else{$(this).val(val).trigger("change")}}option.ajax={url:opts.url,dataType:"json",async:false,type:"POST",delay:800,data:function(params){var dps={param:params.term,pageSize:opts.pageSize,pageNo:params.page};if(callBakFun){var callbackdata=callBakFun();if(opts.pdata){opts.pdata=$.extend({},opts.pdata,callbackdata)}else{opts.pdata=callbackdata}}var ps=$.extend({},dps,opts.pdata);return ps},processResults:function(data,page){return{results:data}},cache:true};$(this).select2(option);if(!(val!=null&&val!=""&&val)){if(opts.defaultValue||opts.defaultValue==""){$(this).val(opts.defaultValue).trigger("change")}}}else{option.data=getAjaxDate(opts.url,opts.pdata);$(this).select2(option);if(val!=null&&val!=""&&val){if(val.indexOf(",")>=0){$(this).val(val.split(",")).trigger("change")}else{$(this).val(val).trigger("change")}}else{if(opts.defaultValue){$(this).val(opts.defaultValue).trigger("change")}}}}else{if(opts.dict){if(sid){setSelect2(option,sid,opts.category,val,opts.pparm,opts.pkey,opts.defaultValue)}else{setSelect2Obj(option,$(this),opts.category,val,opts.pparm,opts.pkey,opts.defaultValue)}}else{$(this).select2(option);if(val!=null&&val!=""&&val){if(val.indexOf(",")>=0){$(this).val(val.split(",")).trigger("change")}else{$(this).val(val).trigger("change")}}}}}})}function formatFormSelect2(fid,selectClass){if(selectClass){}else{selectClass="select2"}$("#"+fid+" select."+selectClass).each(function(){if($(this).hasClass("select2-hidden-accessible")){}else{var voptions=$(this).attr("data-option");if(voptions){}else{voptions="{}"}var opts=eval("("+voptions+")");var sid=$(this).attr("id");var val=$(this).attr("pvalue");var d_option={placeholder:t_select2_placeholder,allowClear:true,language:user_language};if(opts.isSearch){}else{d_option.minimumResultsForSearch="Infinity"}var option=$.extend({},d_option,opts);var callBakFun=opts.pdataCallbackFun;if(opts.url){if(opts.url.startWith("/")){if(opts.url.startWith(ctp)){}else{opts.url=ctp+opts.url}}if(opts.pageSize&&opts.pageSize>0){var pindex=$.extend({},{id:val},opts.pdata);option.data=getAjaxDate(opts.url,pindex);$(this).select2(option);if(val!=null&&val!=""&&val){if(val.indexOf(",")>=0){$(this).val(val.split(",")).trigger("change")}else{$(this).val(val).trigger("change")}}option.ajax={url:opts.url,dataType:"json",async:false,type:"POST",delay:250,data:function(params){var dps={param:params.term,pageSize:opts.pageSize,pageNo:params.page};if(callBakFun){var callbackdata=callBakFun();if(opts.pdata){opts.pdata=$.extend({},opts.pdata,callbackdata)}else{opts.pdata=callbackdata}}var ps=$.extend({},dps,opts.pdata);return ps},processResults:function(data,page){return{results:data}},cache:true};$(this).select2(option);if(!(val!=null&&val!=""&&val)){if(opts.defaultValue||opts.defaultValue==""){$(this).val(opts.defaultValue).trigger("change")}}}else{option.data=getAjaxDate(opts.url,opts.pdata);$(this).select2(option);if(val!=null&&val!=""&&val){if(val.indexOf(",")>=0){$(this).val(val.split(",")).trigger("change")}else{$(this).val(val).trigger("change")}}else{if(opts.defaultValue){$(this).val(opts.defaultValue).trigger("change")}}}}else{if(opts.dict){if(sid){setSelect2(option,sid,opts.category,val,opts.pparm,opts.pkey,opts.defaultValue)}else{setSelect2Obj(option,$(this),opts.category,val,opts.pparm,opts.pkey,opts.defaultValue)}}else{$(this).select2(option);if(val!=null&&val!=""&&val){if(val.indexOf(",")>=0){$(this).val(val.split(",")).trigger("change")}else{$(this).val(val).trigger("change")}}}}}})}function setSelect2(e,c,b,f,j,g,h){if(j){}else{j=""}if(g){}else{g=""}var d={category:b,pparm:j,pkey:g};var a=ctp+"/selectOption/getDict";$.ajax({async:false,cache:false,type:"POST",url:a,data:d,success:function(l){var k=setSelect2Option(e,c,l,f,h)}})}function setSelect2Obj(e,d,b,f,j,g,h){if(j){}else{j=""}if(g){}else{g=""}var c={category:b,pparm:j,pkey:g};var a=ctp+"/selectOption/getDict";$.ajax({async:false,cache:false,type:"POST",url:a,data:c,success:function(l){var k=setSelect2OptionObj(e,d,l,f,h)}})}function setSelect2Option(k,d,b,o,q){var n=b;var p="";var c="";if((typeof(o)!="undefined"&&o!=""&&o!=null)||(typeof(q)!="undefined"&&q!=""&&q!=null)){if(typeof(o)!="undefined"&&o!=""&&o!=null){}else{o=q}var m=o.split(",");var a="";for(var h=0;h<n.length;h++){var f=false;var r=n[h].K;for(var e=0;e<m.length;e++){if(r.trim()==m[e].trim()){f=true;break}}var l=n[h].V2;if(l){if(a!=l){if(h==0){p+="<optgroup label='"+l+"'>"}else{p+="</optgroup><optgroup label='"+l+"'>"}}}if(f){p+="<option value='"+r+"' selected>"+n[h].V+"</option>"}else{p+="<option value='"+r+"'>"+n[h].V+"</option>"}a=l}}else{for(var h=0;h<n.length;h++){var l=n[h].V2;if(l){if(a!=l){if(h==0){p+="<optgroup label='"+l+"'>"}else{p+="</optgroup><optgroup label='"+l+"'>"}}}else{}if(h==0){c=n[h].K}else{}p+="<option value='"+n[h].K+"'>"+n[h].V+"</option>";a=l}}$("#"+d).html(p);if(k==null){k={language:user_language,placeholder:t_select2_placeholder,allowClear:true}}if($("#"+d).attr("multiple")){$("#"+d).select2({language:user_language,placeholder:t_select2_placeholder,allowClear:false})}else{$("#"+d).select2(k)}if(o!=null&&o!=""&&o){}else{$("#"+d).val(null).trigger("change")}return c}function setSelect2OptionObj(k,h,b,o,q){var n=b;var p="";var c="";if((typeof(o)!="undefined"&&o!=""&&o!=null)||(typeof(q)!="undefined"&&q!=""&&q!=null)){if(typeof(o)!="undefined"&&o!=""&&o!=null){}else{o=q}var m=o.split(",");var a="";for(var f=0;f<n.length;f++){var e=false;var r=n[f].K;for(var d=0;d<m.length;d++){if(r.trim()==m[d].trim()){e=true;break}}var l=n[f].V2;if(l){if(a!=l){if(f==0){p+="<optgroup label='"+l+"'>"}else{p+="</optgroup><optgroup label='"+l+"'>"}}}if(e){p+="<option value='"+r+"' selected>"+n[f].V+"</option>"}else{p+="<option value='"+r+"'>"+n[f].V+"</option>"}a=l}}else{for(var f=0;f<n.length;f++){var l=n[f].V2;if(l){if(a!=l){if(f==0){p+="<optgroup label='"+l+"'>"}else{p+="</optgroup><optgroup label='"+l+"'>"}}}else{}if(f==0){c=n[f].K}else{}p+="<option value='"+n[f].K+"'>"+n[f].V+"</option>";a=l}}$(h).html(p);if(k==null){k={language:user_language,placeholder:t_select2_placeholder,allowClear:true}}if($(h).attr("multiple")){$(h).select2({language:user_language,placeholder:t_select2_placeholder,allowClear:false})}else{$(h).select2(k)}if(o!=null&&o!=""&&o){}else{$(h).val(null).trigger("change")}return c}function getSubSelect2(b,d,a,c){$.ajax({url:b,data:d,type:"POST",success:function(f){var e=setSelect2Option(null,a,f);$("#"+a).select2().val(e).trigger("change")}})}function getSubSelect22(b,d,a,c){$.ajax({url:b,data:d,type:"POST",success:function(e){setkOption(null,a,e)}})}function BOpenWindow(a){$("#"+a).modal("show")}function BOpenWindowUrl(c,g,e,b){var j="";if(g){j=g}else{j=""}var a=0;if(e){a=e-40}else{a=$(window).height()-200}var d=0;if(b){d=e}else{d=$(window).width()-500}var f=$('<div class="modal inmodal fade" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header" style="padding-top: 15px;padding-bottom: 10px;"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button><h4 class="modal-title" style="text-align: left;font-size: 16px;">'+j+'</h4></div><div class="modal-body" style="padding:0px;height: '+a+'px;"><iframe style="display: inline;" marginwidth="0" marginheight="0" seamless src="'+c+'" width="100%" height="100%" frameborder="0" ></iframe></div></div></div></div>');f.modal({show:true,backdrop:"static"})}function Btn_FilterForm_More(b){var a=(b.className=="sm-wrap");if(a){b.className="sm-wrap opened";b.firstChild.textContent="收起查询";$("#Filter_Body").show()}else{b.className="sm-wrap";b.firstChild.textContent="展开查询";$("#Filter_Body").hide()}}function ajaxClick(a,b){$("span[name='"+a+"']").click(function(){var c=$(this).attr("data");confirm_swal(null,null,null,function(d){if(d){bloadMask();$.ajax({type:b,url:c,success:function(e){if(e){bUnloadMask()}else{window.location.reload()}}})}})})}function openLayerIFrame(c,a,b){if(b){}else{b=["80%","80%"]}return layer.open({type:2,title:c+" ",area:b,anim:2,shadeClose:false,content:a,maxmin:true})}function openLayerIFrameHasFlushDt(d,b,c,a){if(c&&c!=null){}else{c=["80%","80%"]}return layer.open({type:2,title:d+" ",area:c,anim:2,shadeClose:false,content:b,maxmin:true,end:function(){$("#"+a).DataTable().ajax.reload(null,false)}})}function openLayerIFrameHasFlushDtHasConfirm(d,b,c,a){if(c&&c!=null){}else{c=["80%","80%"]}return layer.open({type:2,title:d+" ",area:c,anim:2,shadeClose:false,content:b,maxmin:true,end:function(){$("#"+a).DataTable().ajax.reload(null,false)},cancel:function(f,e){if(confirm($.i18nText("layer.close.confirm"))){layer.close(f)}return false}})}function openLayerIFrameHasCallBack(c,a,b,d){if(b&&b!=null){}else{b=["80%","80%"]}return layer.open({type:2,title:c+" ",area:b,anim:2,shadeClose:false,content:a,maxmin:true,end:function(){d()}})}function openLayerIFrameHasFlushPage(c,a,b){openLayerIFrameHasCallBack(c,a,b,function(){window.location.reload()})}function ajaxSubmitFormByIdAndFlushDt(a){if(a){}else{a="form_addOrUpdate"}ajaxSubmitFormById(a,function(){bUnloadMask();closeLayer()})}function ajaxSubmitFormByIdAndBack(b,a){ajaxSubmitFormById(b,function(c){bUnloadMask();if(c.success){if(a){eduLoadMask(a)}else{window.history.go(-1)}}})}function closeLayer(){var a=parent.layer.getFrameIndex(window.name);parent.layer.close(a)}function openLayerContent(c,b,a){if(a){}else{a=["80%","80%"]}layer.open({type:1,title:c+" ",area:a,anim:2,shadeClose:true,content:b,maxmin:true})}function change_layout(a){$("body").toggleClass(a);$.AdminLTE.layout.fixSidebar();if(a=="layout-boxed"){$.AdminLTE.controlSidebar._fix($(".control-sidebar-bg"))}if($("body").hasClass("fixed")&&a=="fixed"){$.AdminLTE.pushMenu.expandOnHover();$.AdminLTE.layout.activate()}$.AdminLTE.controlSidebar._fix($(".control-sidebar-bg"));$.AdminLTE.controlSidebar._fix($(".control-sidebar"))}function hisback(){history.go(-1)}function setMfalg(){if(getMfalg()==1){setCookie("mflag",0)}else{setCookie("mflag",1)}}function getMfalg(){var a=getCookie("mflag");if(a==null){a=0}return a}ulocale=user_language;$.ajaxSetup({headers:{"X-CSRF-TOKEN":$("#csrf_token").attr("content")},timeout:900000,cache:false});function showTimer(){setTimeout("showServerTime()",1000)}function showServerTime(){var j=new Date($.ajax({async:false}).getResponseHeader("Date"));var e=new Array(7);e[1]="星期一";e[2]="星期二";e[3]="星期三";e[4]="星期四";e[5]="星期五";e[6]="星期六";e[0]="星期日";var k=j.getFullYear()+"年";var f=j.getMonth()+1+"月";var b=j.getDate()+"日";var g=e[j.getDay()];var c=j.getHours();var a=j.getMinutes();var l=j.getSeconds();$("#clock").html(k+f+b+" "+c+":"+a+":"+l+"("+g+")")}function formatMenu(c,b,d,f,e,a){$("#sidebar-menu").find("a[href='"+(c)+"']").each(function(){var k=$(this);var j=k.children("span[class='pull-right-container']");var r="bg-green";var l=5;if(d=="1"){r="bg-aqua";l=2}else{if(d=="2"){r="bg-yellow";l=3}else{if(d=="3"){r="bg-red";l=1}}}if(j.length==0){k.append('<span class="pull-right-container"><small class="todoP label pull-right '+r+'">'+b+"</small></span>")}else{j.first().html('<small class="todoP label pull-right '+r+'">'+b+"</small>")}try{var h=$(this).parents(".treeview").find("a").first();var g=h.children("span[class='pull-right-container']");if(g.length==0){}else{if(typeof(bgParentNumType)=="undefined"){g.first().append('<small class="todoP bgParentNum label pull-right '+r+'" >'+b+"</small>")}else{if(g.first().find(".bgParentNum").length>0){var q=g.first().find(".bgParentNum").first();var m=q.html();q.html(parseInt(m)+parseInt(b))}else{g.first().append('<small class="todoP bgParentNum label pull-right bg-red" >'+b+"</small>")}}}}catch(o){}});$("#sidebar-menu").find("a[url='"+(c)+"']").each(function(){var k=$(this);var j=k.children("span[class='pull-right-container']");var r="bg-green";var l=5;if(d=="1"){r="bg-aqua";l=2}else{if(d=="2"){r="bg-yellow";l=3}else{if(d=="3"){r="bg-red";l=1}}}if(j.length==0){k.append('<span class="pull-right-container"><small class="todoP label pull-right '+r+'">'+b+"</small></span>")}else{j.first().html('<small class="todoP label pull-right '+r+'">'+b+"</small>")}try{var h=$(this).parents(".treeview").find("a").first();var g=h.children("span[class='pull-right-container']");if(g.length==0){}else{if(typeof(bgParentNumType)=="undefined"){g.first().append('<small class="todoP bgParentNum label pull-right '+r+'" >'+b+"</small>")}else{if(g.first().find(".bgParentNum").length>0){var q=g.first().find(".bgParentNum").first();var m=q.html();q.html(parseInt(m)+parseInt(b))}else{g.first().append('<small class="todoP bgParentNum label pull-right bg-red" >'+b+"</small>")}}}}catch(o){}if($(this).hasClass("level2")){return false}try{var h=$(this).parent().parent().parent().find("a.level2").first();var g=h.children("span[class='pull-right-container']");if(g.length==0){}else{if(typeof(bgParentNumType)=="undefined"){g.first().append('<small class="todoP bgParentNum label pull-right '+r+'">'+b+"</small>")}else{if(g.first().find(".bgParentNum").length>0){var q=g.first().find(".bgParentNum").first();var m=q.html();q.html(parseInt(m)+parseInt(b))}else{g.first().append('<small class="todoP bgParentNum label pull-right bg-red">'+b+"</small>")}}}}catch(o){}})}function showMsgBRNTodo(b,a,c,d){var e=5;if(c=="1"){bgcl="bg-aqua";e=2}else{if(c=="2"){bgcl="bg-yellow";e=3}else{if(c=="3"){bgcl="bg-red";e=1}}}showMsgBRN(t_todo_title,d,e)}function flushTodolistIframe(){top.todolistFlushIframe()}function todolist(a){if(getQueryVariable("exclude")){return false}$.ajax({url:ctp+"/tools/todo/list",type:"GET",success:function(f){if(f.success){var e=f.data;var g="";var b=0;for(var c=0;c<e.length;c++){g+="<li title='"+e[c].title+"'><a href='"+ctp+e[c].url+"'><i class='"+e[c].iconclass+"'></i>"+e[c].content+"</li>";b+=e[c].num;formatMenu(e[c].url,e[c].num,e[c].type,e[c].content)}if(a&&a==1){try{if(window.sessionStorage.getItem("todo_status")&&window.sessionStorage.getItem("todo_status")=="1"){}else{for(var c=0;c<e.length;c++){showMsgBRNTodo(e[c].url,e[c].num,e[c].type,e[c].content)}window.sessionStorage.setItem("todo_status","1")}}catch(d){}}else{for(var c=0;c<e.length;c++){showMsgBRNTodo(e[c].url,e[c].num,e[c].type,e[c].content)}}$("#todolist").html(g);if(b>0){$("#todolist_num").text(b);$("#todolist_num").parent().parent().show()}else{$("#todolist_num").text(b);$("#todolist_num").parent().parent().hide()}}}})}function checkPwdDate(a){if(getQueryVariable("exclude")){return false}ajaxtest("/checkPwdDate","",function(d){if(d.success){}else{var b=d.status;var c="";var f=1;if(b==101){f=1;c="密码过期，请修改!"}else{if(b==102){f=3;c="密码即将在"+d.message+"后过期，请及时修改!"}else{if(b==103){f=1;c="密码还没修改过，请修改!"}}}var e="<li title='"+c+"'><a href='"+ctp+"/sysadmin/user/profile'><i class='fa fa-circle text-red'></i>"+c+"</li>";$("#messagelist").append(e);$("#message_num").text(parseInt($("#message_num").text())+1);$("#message_num").parent().parent().show();if(a&&a==1){if(window.sessionStorage.getItem("cpwd_status")&&window.sessionStorage.getItem("cpwd_status")=="1"){return false}else{window.sessionStorage.setItem("cpwd_status","1")}}else{}if(f==1){showMsgBRN("安全提醒","为确保信息安全，请立即修改登录密码！",f)}else{showMsgBRN("安全提醒",c,f)}}})}function addTabsIframe(d,c,a,b){top.addTabs({id:d,title:c,close:true,url:a,icon:b,urlType:"relative"})}var todoListFlag=0;function todolistIframe(a){if(todolistIframe==1){return false}if(getQueryVariable("exclude")){return false}todoListFlag=1;$.ajax({url:ctp+"/tools/todo/list",type:"GET",success:function(f){if(f.success){var e=f.data;var g="";var b=0;for(var c=0;c<e.length;c++){g+="<li title='"+e[c].title+"'><a href='###' onclick=\"topAddTabs('"+e[c].code+"','"+e[c].label+"','"+e[c].url+"','"+e[c].iconclass+"')\" ><i class='"+e[c].iconclass+"'></i>"+e[c].content+"</li>";b+=e[c].num;formatMenu(e[c].url,e[c].num,e[c].type,e[c].content,e[c].code,e[c].label)}if(a&&a==1){try{if(window.sessionStorage.getItem("todo_status")&&window.sessionStorage.getItem("todo_status")=="1"){}else{for(var c=0;c<e.length;c++){showMsgBRNTodo(e[c].url,e[c].num,e[c].type,e[c].content)}window.sessionStorage.setItem("todo_status","1")}}catch(d){}}else{for(var c=0;c<e.length;c++){showMsgBRNTodo(e[c].url,e[c].num,e[c].type,e[c].content)}}$("#todolist").html(g);if(b>0){$("#todolist_num").text(b);$("#todolist_num").parent().parent().show()}else{$("#todolist_num").text(b);$("#todolist_num").parent().parent().hide()}}else{$("#todolist").html("");$("#todolist_num").text(0);$("#todolist_num").parent().parent().hide()}todoListFlag=0}})}function checkPwdDateIframe(a){if(getQueryVariable("exclude")){return false}ajaxtest("/checkPwdDate","",function(d){if(d.success){}else{var b=d.status;var c="";var f=1;if(b==101){f=1;c="密码过期，请修改!"}else{if(b==102){f=3;c="密码即将在"+d.message+"后过期，请及时修改!"}else{if(b==103){f=1;c="密码还没修改过，请修改!"}}}var e="<li title='"+c+"'><a href='###' onclick='openUserProfile()'><i class='fa fa-circle text-red'></i>"+c+"</li>";$("#messagelist").append(e);$("#message_num").text(parseInt($("#message_num").text())+1);$("#message_num").parent().parent().show();if(a&&a==1){if(window.sessionStorage.getItem("cpwd_status")&&window.sessionStorage.getItem("cpwd_status")=="1"){return false}else{window.sessionStorage.setItem("cpwd_status","1")}}else{}if(f==1){showMsgBRN("安全提醒","为确保信息安全，请立即修改登录密码！",f)}else{showMsgBRN("安全提醒",c,f)}}})}function openUserProfile(){addIframeToTabs("UserProfile","个人设置","/sysadmin/user/profile")}function addIframeToTabs(c,b,a){addTabs({id:c,title:b,close:true,url:a,urlType:"relative"});App.fixIframeCotent()}function getQueryVariable(a){var c=window.location.search.substring(1);var d=c.split("&");for(var b=0;b<d.length;b++){var e=d[b].split("=");if(e[0]==a){return e[1]}}return(false)}function initSwitchery(a){$(a).each(function(b,c){new Switchery($(a)[b],{color:"#1AB394"})})};